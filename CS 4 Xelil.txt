1)
SELECT *
FROM hr.employees
WHERE salary=(SELECT min(salary) FROM hr.employees
emp WHERE department_id=90) AND department_id=90;

SELECT *
FROM (SELECT department_id,last_name,salary,dense_rank() over(partition by department_id
      ORDER BY salary ASC)dr 
      FROM hr.employees
      WHERE department_id=90
      ORDER BY dr,last_name) 
WHERE dr=1;

2)
SELECT department_id,
       last_name,
       salary,
       DENSE_RANK() OVER (PARTITION BY department_id
       ORDER BY salary ASC) dr
FROM hr.employees
WHERE department_id IN (30,40);

3)
SELECT *
FROM (SELECT department_id,
             last_name,
             salary,
             DENSE_RANK() OVER(PARTITION BY department_id
             ORDER BY salary ASC) AS dr
       FROM hr.employees
       WHERE department_id=50);
       
4)
SELECT last_name,
       hire_date,
       salary,
       LAG(to_char(salary),2,'yoxdur')
       OVER(ORDER BY hire_date)
FROM hr.employees
WHERE job_id='IT_PROG';

5)
SELECT *
FROM hr.employees emp
INNER JOIN hr.jobs j ON emp.job_id=j.job_id
INNER JOIN hr.job_history jh ON emp.employee_id=jh.employee_id
WHERE jh.job_id='IT_PROG';

6)
CREATE TABLE emp_copy6 AS (SELECT * FROM hr.employees);
UPDATE emp_copy6 ec
SET ec.salary=(SELECT MAX(SALARY)
               FROM hr.employees emp 
               WHERE emp.department_id=ec.department_id);

SELECT *
FROM emp_copy6;

7)
UPDATE emp_copy6 ec SET ec.salary=ec.salary*1.3;

SELECT * 
FROM emp_copy6;