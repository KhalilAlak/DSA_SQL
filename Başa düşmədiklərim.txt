/*Week 2 Homework 2)Display employees who joined in the current year.*/
SELECT *
FROM hr.employees
WHERE EXTRACT(YEAR FROM hire_date) = EXTRACT(YEAR FROM SYSDATE);

/*Week 3 HomeWork 2. Display department name, manager name, and salary of the manager for all managers whose
experience is more than 5 years. */
2)
SELECT DISTINCT(dep.department_name),
       man.first_name||' '||man.last_name manager_name,
       man.salary
FROM hr.employees emp
JOIN hr.employees man ON emp.manager_id=man.employee_id
JOIN hr.departments dep ON man.department_id = dep.department_id
WHERE MONTHS_BETWEEN(sysdate, emp.hire_date)/12 >= 5;

/*3)Display employee name if the employee joined before his manager.*/
3)
SELECT emp.first_name||' '||emp.last_name Full_Name,
       emp.employee_id emp_id,
       emp.manager_id man_id,
       emp.hire_date emp_hire_date,
       man.hire_date man_hire_date
FROM hr.employees emp
JOIN hr.employees man ON emp.manager_id = man.employee_id
WHERE emp.hire_date < man.hire_date
ORDER BY emp_id;
